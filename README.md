# Pastry Shop "Confititeria"

Проєкт веб-сайту для кондитерської "Confititeria", розроблений на Django. Дозволяє переглядати асортимент, робити замовлення та керувати ними через адміністративну панель.

## Вміст

*   [Технології](#технології)
*   [Встановлення та налаштування](#встановлення-та-налаштування)
    *   [Вимоги](#вимоги)
    *   [Крок 1: Налаштування середовища](#крок-1-налаштування-середовища)
    *   [Крок 2: Налаштування бази даних та створення адміністратора](#крок-2-налаштування-бази-даних-та-створення-адміністратора)
    *   [Крок 3: Налаштування змінних оточення (.env)](#крок-3-налаштування-змінних-оточення-env)
*   [Запуск та зупинка сервера](#запуск-та-зупинка-сервера)
*   [Структура проєкту](#структура-проєкту)
*   [Основні функції сайту](#основні-функції-сайту)
*   [Використання адмін-панелі](#використання-адмін-панелі)
    *   [Управління асортиментом](#управління-асортиментом)
    *   [Управління замовленнями](#управління-замовленнями)
*   [Можливі проблеми та їх вирішення](#можливі-проблеми-та-їх-вирішення)

## Технології

*   **Python 3.8+**
*   **Django 5.1.6** - Python веб-фреймворк
*   **Bootstrap 5** - CSS-фреймворк для адаптивного дизайну
*   **SQLite** - база даних (використовується за замовчуванням для розробки)
*   **python-dotenv** - для управління змінними оточення (безпечне зберігання секретів)
*   **django-cleanup** - для автоматичного видалення медіафайлів при видаленні пов'язаних об'єктів моделей
*   **Pillow** - бібліотека для роботи із зображеннями

## Встановлення та налаштування

### Вимоги

*   Python 3.8 або новішої версії.
*   Система керування версіями Git (рекомендовано для клонування, якщо проєкт на GitHub).
*   Windows (оскільки використовуються `.bat` файли).

### Крок 1: Налаштування середовища

1.  **Клонуйте репозиторій** (якщо проєкт на GitHub) або **розпакуйте архів** з проєктом у зручну для вас папку.
2.  Перейдіть до кореневої папки проєкту в командному рядку.
3.  Запустіть файл `setup_env.bat` подвійним кліком або командою в консолі:
    ```bash
    setup_env.bat
    ```
    Цей скрипт:
    *   Створить віртуальне середовище у папці `venv/`.
    *   Активує його.
    *   Встановить всі необхідні залежності з файлу `requirements.txt`.
4.  Дочекайтесь завершення встановлення.

### Крок 2: Налаштування бази даних та створення адміністратора

Скрипт `reset_db.bat` призначений для початкового налаштування бази даних при першому встановленні проєкту або для повного скидання бази даних до початкового стану (наприклад, у випадку проблем).

**Увага:** Запуск `reset_db.bat` видалить файл `db.sqlite3` (якщо він існує) та всі дані в ньому.

1.  Запустіть файл `reset_db.bat` подвійним кліком або командою в консолі:
    ```bash
    reset_db.bat
    ```
    Цей скрипт:
    *   Видалить існуючий файл бази даних `db.sqlite3` (якщо він є).
    *   Видалить попередні файли міграцій для додатку `shop` (щоб забезпечити чисте створення).
    *   Створить нові міграції на основі поточних моделей.
    *   Застосує міграції для створення структури бази даних.
    *   Запропонує створити **суперкористувача** (адміністратора). Дотримуйтесь інструкцій на екрані, щоб ввести ім'я користувача, email (необов'язково) та пароль. **Запам'ятайте ці дані!**

2.  Після запуску сайту та входу в адмін-панель, вам потрібно буде **додати товари до асортименту** вручну через розділ `Shop` -> `Assortment items`.

### Крок 3: Налаштування змінних оточення (.env)

Для коректної роботи, зокрема для відправки email-сповіщень про замовлення, необхідно налаштувати змінні оточення.

1.  У кореневій папці проєкту створіть файл з назвою `.env` (якщо його ще немає).
2.  Додайте до файлу `.env` наступні рядки, замінивши значення на ваші реальні дані:

    ```env
    # Django Secret Key (згенеруйте власний унікальний ключ для продакшну)
    # Для розробки можна залишити як є, або Django згенерує тимчасовий
    DJANGO_SECRET_KEY='your_very_secret_django_key_here_for_production'

    # Режим відладки (True для розробки, False для продакшну)
    DJANGO_DEBUG=True

    # Дозволені хости (через кому, без пробілів; для продакшну вкажіть ваш домен)
    DJANGO_ALLOWED_HOSTS=127.0.0.1,localhost

    # Email Settings for Order Notifications (приклад для Gmail)
    EMAIL_HOST_USER='your-email@gmail.com'
    EMAIL_HOST_PASSWORD='your-gmail-app-password' # Важливо: використовуйте пароль додатка, а не основний пароль!
    ADMIN_EMAIL='your-admin-email-for-notifications@example.com' # Куди будуть надходити сповіщення

    # Опціонально, якщо відрізняється від стандартних для Gmail:
    # EMAIL_HOST='smtp.gmail.com'
    # EMAIL_PORT=587
    # EMAIL_USE_TLS=True
    # DEFAULT_FROM_EMAIL='your-email@gmail.com' # Якщо відрізняється від EMAIL_HOST_USER
    ```

    **Важливо щодо `EMAIL_HOST_PASSWORD` для Gmail:**
    *   Вам потрібно створити "Пароль додатка" у налаштуваннях безпеки вашого Google акаунту. Не використовуйте основний пароль!
    *   Для цього у вас має бути увімкнена двофакторна автентифікація.
    *   Детальні інструкції можна знайти в файлі `ІНСТРУКЦІЯ.md` (розділ 2.2) або в офіційній документації Google.

3.  Збережіть файл `.env`.

## Запуск та зупинка сервера

*   **Для запуску сервера розробки:**
    Запустіть файл `run_server.bat`:
    ```bash
    run_server.bat
    ```
    Сайт буде доступний за адресою: [http://127.0.0.1:8000/](http://127.0.0.1:8000/)
    Адмін-панель: [http://127.0.0.1:8000/admin/](http://127.0.0.1:8000/admin/)

*   **Для зупинки сервера:**
    У вікні консолі, де запущений сервер, натисніть `Ctrl+C`.
    Або запустіть файл `stop_server.bat` (може не завжди коректно спрацьовувати для серверу розробки Django, найнадійніше - `Ctrl+C`).

## Структура проєкту

*   `my_bakery/`: Папка конфігурації проєкту Django.
    *   `settings.py`: Основні налаштування проєкту.
    *   `urls.py`: Головний файл URL-маршрутизації.
*   `shop/`: Основний додаток сайту.
    *   `models.py`: Моделі даних (Асортимент, Замовлення).
    *   `views.py`: Логіка обробки запитів (контролери).
    *   `forms.py`: Форми Django (форма замовлення).
    *   `urls.py`: URL-маршрутизація для додатку `shop`.
    *   `admin.py`: Налаштування відображення моделей в адмін-панелі.
    *   `templates/shop/`: HTML-шаблони для сторінок сайту.
    *   `migrations/`: Файли міграцій бази даних.
*   `static/`: Статичні файли (CSS, зображення для дизайну).
*   `media/`: Медіафайли, завантажені користувачами/адміністратором (наприклад, зображення товарів).
    *   `assortment/`: Зображення для товарів асортименту.
*   `venv/`: Папка віртуального середовища (створюється скриптом `setup_env.bat`).
*   `manage.py`: Утиліта Django для управління проєктом.
*   `requirements.txt`: Список залежностей Python.
*   `.bat` файли: Скрипти для автоматизації завдань на Windows.
*   `.env`: Файл для зберігання змінних оточення (створюється вручну).

## Основні функції сайту

1.  **Головна сторінка:**
    *   Вітальна інформація.
    *   Огляд бестселерів (перші 4 товари з асортименту).
    *   Посилання на інші сторінки.
2.  **Асортимент:**
    *   Повний перелік кондитерських виробів з назвами, зображеннями, цінами.
    *   Можливість пошуку за назвою та фільтрації за ціною.
    *   Кнопка "Замовити" для кожного товару, що веде до форми замовлення.
3.  **Про нас:**
    *   Інформація про кондитерську, її історію, філософію та команду.
4.  **Форма замовлення ("Зробити замовлення"):**
    *   Форма для вибору товару, вказання кількості, дати доставки, контактних даних.
    *   Валідація введених даних.
    *   Автоматичний розрахунок загальної суми замовлення (на стороні клієнта, JavaScript).
    *   Фейкова форма оплати карткою (демонстраційна, без реальних транзакцій).
    *   Після успішного оформлення – перехід на сторінку підтвердження та відправка email-сповіщення адміністратору.
5.  **Сторінка успішного замовлення:**
    *   Повідомлення про успішне прийняття замовлення.

## Використання адмін-панелі

Доступ до адмін-панелі: [http://127.0.0.1:8000/admin/](http://127.0.0.1:8000/admin/)
Використовуйте логін та пароль суперкористувача, створені на етапі налаштування бази даних.

### Управління асортиментом

*   Розділ: `Shop` -> `Assortment items`.
*   **Додавання:** Натисніть "Add assortment item". Заповніть назву, ціну, завантажте зображення (необов'язково).
*   **Редагування:** Клікніть на назву товару для зміни даних.
*   **Видалення:** Виберіть товари у списку та оберіть дію "Delete selected assortment items".

### Управління замовленнями

*   Розділ: `Shop` -> `Orders`.
*   **Перегляд:** Список всіх замовлень з основною інформацією.
*   **Деталі:** Клікніть на номер замовлення (ID) або ім'я замовника для перегляду повної інформації.
*   **Редагування статусу:** У формі редагування замовлення можна змінити його статус (Новий, Прийнято, Виконується тощо).
*   **Фільтрація та пошук:** Використовуйте фільтри за статусом, товаром, датою доставки. Пошук доступний за ім'ям клієнта, телефоном, email, назвою товару.

## Можливі проблеми та їх вирішення

1.  **Сайт не запускається / помилки при запуску `run_server.bat`:**
    *   Переконайтеся, що віртуальне середовище активовано. Якщо ви відкрили нове вікно консолі, активуйте його вручну: `call venv\Scripts\activate.bat`.
    *   Перевірте, чи всі залежності встановлені (`setup_env.bat` мав це зробити).
    *   Перевірте файл `.env` на наявність та правильність ключа `DJANGO_SECRET_KEY`.
2.  **Не надсилаються email-сповіщення про замовлення:**
    *   Перевірте правильність налаштувань `EMAIL_HOST_USER`, `EMAIL_HOST_PASSWORD`, `ADMIN_EMAIL` у файлі `.env`.
    *   Для Gmail переконайтеся, що використовується "пароль додатка" і що доступ для менш безпечних додатків дозволений або двофакторна автентифікація налаштована коректно.
    *   Перевірте налаштування вашого антивірусу або брандмауера, вони можуть блокувати SMTP-з'єднання.
3.  **Проблеми із зображеннями (не відображаються, помилки при завантаженні):**
    *   Переконайтеся, що бібліотека `Pillow` встановлена (має бути в `requirements.txt` та встановлена через `setup_env.bat`).
    *   Перевірте права доступу до папки `media/`.
4.  **Потрібно скинути базу даних і почати з чистого аркуша:**
    *   Запустіть `reset_db.bat`. Пам'ятайте, що це видалить всі дані (товари, замовлення) і вам потрібно буде знову створити суперкористувача.